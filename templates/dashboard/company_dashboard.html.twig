{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/dashboard.css') }}">
{% endblock %}

{% block title %}Tableau de bord {{ company.name }}{% endblock %}

{% block body %}
<div class="dashboard-container">
    <header class="dashboard-header">
        <h1>Bienvenue, {{ company.name }}</h1>
    </header>

    <nav class="dashboard-nav">
        <ul>
            <li><a href="#company-info">Informations de l'entreprise</a></li>
            <li><a href="#services">Services</a></li>
            <li><a href="#schedule">Horaires</a></li>
            <li><a href="#reservations">Réservations</a></li>
        </ul>
    </nav>

    <div class="dashboard-content">
        <section id="company-info" class="dashboard-section company-info">
            <h2>Informations de l'entreprise</h2>
            <div class="info-card">
                <h3>{{ company.name }}</h3>
                <p><i class="fas fa-map-marker-alt"></i> {{ company.address }}</p>
                <p><i class="fas fa-phone"></i> {{ company.phoneNumber }}</p>
                <p><i class="fas fa-envelope"></i> {{ company.email }}</p>
                <p><i class="fas fa-info-circle"></i> {{ company.description }}</p>
                <a href="{{ path('company_update') }}" class="btn btn-primary">Modifier les informations</a>
            </div>
        </section>

        <section id="services" class="dashboard-section services">
            <h2>Vos Services</h2>
            {% if company.services is not empty %}
                <div class="services-list">
                    {% for service in company.services %}
                        <div class="service-card">
                            <h3>{{ service.name }}</h3>
                            <p>{{ service.description }}</p>
                            <p><strong>Prix:</strong> {{ service.price }} €</p>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p>Vous n'avez pas encore ajouté de services.</p>
            {% endif %}
            <a href="{{ path('company_services') }}" class="btn btn-primary">Gérer les services</a>
        </section>

        <section id="schedule" class="dashboard-section schedule">
            <h2>Horaires d'ouverture</h2>
            {% if company.schedules is not empty %}
                <ul class="opening-hours">
                    {% for schedule in company.schedules %}
                        <li>
                            <span>{{ schedule.dayOfWeek }}:</span> 
                            {{ schedule.openingTime|date('H:i') }} - {{ schedule.closingTime|date('H:i') }}
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>Vous n'avez pas encore défini vos horaires d'ouverture.</p>
            {% endif %}
            <a href="{{ path('company_schedule') }}" class="btn btn-primary">Gérer les horaires</a>
        </section>

        <section id="reservations" class="dashboard-section reservations">
            <h2>Vos Réservations</h2>
            {% if reservations is not empty %}
                <div class="reservations-list">
                    {% for reservation in reservations %}
                        <div class="reservation-card">
                            <h3>Réservation #{{ reservation.id }}</h3>
                            <p><i class="far fa-calendar-alt"></i> {{ reservation.dateTime|date('d/m/Y H:i') }}</p>
                            <p><i class="fas fa-user"></i> {{ reservation.standardUser.firstName }} {{ reservation.standardUser.lastName }}</p>
                            <p><i class="fas fa-envelope"></i> {{ reservation.standardUser.email }}</p>
                            <p><i class="fas fa-phone"></i> {{ reservation.standardUser.phoneNumber }}</p>
                            <p><i class="fas fa-tag"></i> Service: {{ reservation.service.name }}</p>
                            <p><i class="fas fa-comment"></i> Statut: {{ reservation.status }}</p>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p>Vous n'avez pas encore de réservations.</p>
            {% endif %}
        </section>
    </div>
</div>
{% endblock %}